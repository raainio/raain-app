"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1052],{1052:(I,f,c)=>{c.r(f),c.d(f,{RadarsPageModule:()=>A});var g=c(6895),m=c(433),a=c(4556),u=c(1407),_=c(5861),p=c(4718),n=c(8256),h=c(6568);function Z(o,s){if(1&o){const e=n.EpF();n.TgZ(0,"ion-card",5)(1,"ion-card-header")(2,"ion-card-title"),n._uU(3,"Your radars"),n.qZA(),n.TgZ(4,"ion-card-subtitle"),n._uU(5," Radars information "),n.qZA()(),n.TgZ(6,"ion-card-content")(7,"p"),n._uU(8,"Manage here your radar status."),n.qZA()(),n.TgZ(9,"ion-button",6),n.NdJ("click",function(){n.CHM(e);const i=n.oxw();return n.KtG(i.closeInfo("welcome-card"))}),n._uU(10,"Got it"),n.qZA()()}}function x(o,s){if(1&o){const e=n.EpF();n.TgZ(0,"ion-label",16),n.NdJ("click",function(){n.CHM(e);const i=n.oxw().$implicit,r=n.oxw(2);return n.KtG(r.navigateToZone(i))}),n._uU(1," Rain zone attached "),n.qZA()}}function R(o,s){if(1&o){const e=n.EpF();n.TgZ(0,"ion-icon",17),n.NdJ("click",function(){n.CHM(e);const i=n.oxw().$implicit,r=n.oxw(2);return n.KtG(r.navigateToZone(i))}),n.qZA()}}function T(o,s){if(1&o){const e=n.EpF();n.TgZ(0,"ion-icon",18),n.NdJ("click",function(){n.CHM(e);const i=n.oxw().$implicit,r=n.oxw(2);return n.KtG(r.navigateToZone(i))}),n.qZA()}}function k(o,s){if(1&o){const e=n.EpF();n.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",19)(3,"ion-button",20),n.NdJ("click",function(){n.CHM(e);const i=n.oxw().$implicit,r=n.oxw(2);return n.KtG(r.saveRadar(i))}),n._uU(4,"Save"),n.qZA()()()(),n.TgZ(5,"ion-content",21)(6,"ion-item")(7,"ion-input",22),n.NdJ("ngModelChange",function(i){n.CHM(e);const r=n.oxw().$implicit;return n.KtG(r.name=i)}),n.qZA()()()}if(2&o){const e=n.oxw().$implicit;n.xp6(3),n.Q6J("strong",!0),n.xp6(4),n.Q6J("ngModel",e.name)}}function P(o,s){if(1&o){const e=n.EpF();n.TgZ(0,"ion-item-sliding")(1,"ion-item-options",8)(2,"ion-item-option",9),n.NdJ("click",function(){const r=n.CHM(e).$implicit,l=n.oxw(2);return n.KtG(l.deleteRadar(r))}),n._uU(3," Delete "),n.qZA()(),n.TgZ(4,"ion-item"),n._UZ(5,"ion-icon",10),n.TgZ(6,"ion-button",11),n._uU(7),n.qZA(),n.YNc(8,x,2,0,"ion-label",12),n.YNc(9,R,1,0,"ion-icon",13),n.YNc(10,T,1,0,"ion-icon",14),n.qZA(),n.TgZ(11,"ion-modal",15),n.NdJ("willDismiss",function(){const r=n.CHM(e).$implicit,l=n.oxw(2);return n.KtG(l.saveRadar(r))}),n.YNc(12,k,8,2,"ng-template"),n.qZA()()}if(2&o){const e=s.$implicit;n.xp6(6),n.MGl("id","open-modal-radar#",e.id,""),n.xp6(1),n.AsE("",e.name," ",e.description," "),n.xp6(1),n.Q6J("ngIf",null==e.zones?null:e.zones.length),n.xp6(1),n.Q6J("ngIf",(null==e.zones?null:e.zones.length)&&!e.hasSomeData),n.xp6(1),n.Q6J("ngIf",(null==e.zones?null:e.zones.length)&&e.hasSomeData),n.xp6(1),n.MGl("trigger","open-modal-radar#",e.id,"")}}function y(o,s){if(1&o&&(n.TgZ(0,"ion-list"),n.YNc(1,P,13,7,"ion-item-sliding",7),n.qZA()),2&o){const e=n.oxw();n.xp6(1),n.Q6J("ngForOf",e.radars)}}let w=(()=>{var o;class s{constructor(t,i){this.profile=t,this.router=i,this.radarsInfoAlreadyViewed={},this.radars=[]}ngOnInit(){this.refresh()}refresh(t){var i=this;return(0,_.Z)(function*(){try{i.sessionData=yield i.profile.refreshProfile(),i.sessionData.infos.radarsInfoAlreadyViewed&&(i.radarsInfoAlreadyViewed=i.sessionData.infos.radarsInfoAlreadyViewed),i.radars=yield i.profile.getRadars(i.profile.asTeamId);for(const r of i.radars){const l=yield i.getLinkedZones(r);if(l.length){const d=yield i.profile.getRainTimeframe(l[0],new Date("2018-01-01"),new Date("2030-01-01"));r.hasSomeData=d&&d.getLinksCount(p.RadarMeasure.TYPE)&&d.getLinksCount(p.RainComputation.TYPE)}}}catch(r){console.error("refresh  pb:",r)}t&&t.target.complete()})()}closeInfo(t){var i=this;return(0,_.Z)(function*(){i.radarsInfoAlreadyViewed[t]=!0,i.sessionData&&i.sessionData.infos&&(i.sessionData.infos.radarsInfoAlreadyViewed=i.radarsInfoAlreadyViewed,yield i.profile.storeAll())})()}deleteRadar(t){}getLinkedZones(t){return(0,_.Z)(function*(){const i=t.getLinksCount("rain"),r=[];for(let l=0;l<i;l++){const d=t.getLink("rain",l);r.push(d.getId())}return r})()}navigateToZone(t){var i=this;return(0,_.Z)(function*(){return i.router.navigate(["/rains",t.getLinkId("rain",0)])})()}saveRadar(t){var i=this;return(0,_.Z)(function*(){yield i.profile.putRadar(t),yield i.refresh(),yield i.modal.dismiss()})()}}return(o=s).\u0275fac=function(t){return new(t||o)(n.Y36(h.H),n.Y36(u.F0))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-radars"]],viewQuery:function(t,i){if(1&t&&n.Gf(a.ki,5),2&t){let r;n.iGM(r=n.CRH())&&(i.modal=r.first)}},decls:12,vars:2,consts:[["slot","start"],["src","assets/icon/favicon.ico",2,"height","30px","padding-left","20px"],["slot","fixed",3,"ionRefresh"],["class","welcome-card",4,"ngIf"],[4,"ngIf"],[1,"welcome-card"],["fill","outline",3,"click"],[4,"ngFor","ngForOf"],["side","start"],["color","danger","expandable","true",3,"click"],["color","primary","name","wifi","slot","start"],["expand","block","fill","clear",3,"id"],["slot","end",3,"click",4,"ngIf"],["color","primary","name","checkmark-circle","slot","end",3,"click",4,"ngIf"],["color","success","name","checkmark-circle","slot","end",3,"click",4,"ngIf"],[3,"trigger","willDismiss"],["slot","end",3,"click"],["color","primary","name","checkmark-circle","slot","end",3,"click"],["color","success","name","checkmark-circle","slot","end",3,"click"],["slot","end"],[3,"strong","click"],[1,"ion-padding"],["type","text",3,"ngModel","ngModelChange"]],template:function(t,i){1&t&&(n.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),n._UZ(3,"ion-menu-button")(4,"ion-img",1),n.qZA(),n.TgZ(5,"ion-title"),n._uU(6," Radars "),n.qZA()()(),n.TgZ(7,"ion-content")(8,"ion-refresher",2),n.NdJ("ionRefresh",function(l){return i.refresh(l)}),n._UZ(9,"ion-refresher-content"),n.qZA(),n.YNc(10,Z,11,0,"ion-card",3),n.YNc(11,y,2,1,"ion-list",4),n.qZA()),2&t&&(n.xp6(10),n.Q6J("ngIf",!i.radarsInfoAlreadyViewed.hasOwnProperty("welcome-card")),n.xp6(1),n.Q6J("ngIf",i.radars))},dependencies:[g.sg,g.O5,m.JJ,m.On,a.YG,a.Sm,a.PM,a.FN,a.Zi,a.tO,a.Dq,a.W2,a.Gu,a.gu,a.Xz,a.pK,a.Ie,a.u8,a.IK,a.td,a.Q$,a.q_,a.fG,a.nJ,a.Wo,a.wd,a.sr,a.ki,a.j9],styles:[".content-card[_ngcontent-%COMP%]{margin-bottom:100px}ion-list[_ngcontent-%COMP%]{margin-bottom:50px}"]}),s})(),A=(()=>{var o;class s{}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[g.ez,m.u5,a.Pc,u.Bz.forChild([{path:"",component:w}])]}),s})()}}]);