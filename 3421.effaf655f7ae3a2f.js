"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3421],{3421:(z,Z,g)=>{g.r(Z),g.d(Z,{RainsPageModule:()=>V});var m=g(6895),d=g(433),r=g(4556),h=g(1407),c=g(5861),e=g(8256),x=g(6568),f=g(7227);function R(a,l){if(1&a){const i=e.EpF();e.TgZ(0,"ion-card",7)(1,"ion-card-header")(2,"ion-card-title"),e._uU(3,"Rain Zones"),e.qZA(),e.TgZ(4,"ion-card-subtitle"),e._uU(5," Based on radars, Rain zones are supporting rain computing. "),e.qZA()(),e.TgZ(6,"ion-card-content")(7,"p"),e._uU(8,"Manage here rain computing status."),e.qZA()(),e.TgZ(9,"ion-button",8),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.closeInfo("welcome-card"))}),e._uU(10,"Got it"),e.qZA()()}}function C(a,l){1&a&&e._UZ(0,"ion-icon",15)}function P(a,l){1&a&&e._UZ(0,"ion-icon",16)}function v(a,l){if(1&a){const i=e.EpF();e.TgZ(0,"ion-item-sliding")(1,"ion-item"),e.YNc(2,C,1,0,"ion-icon",9),e.ALo(3,"hasGoodQuality"),e.YNc(4,P,1,0,"ion-icon",10),e.ALo(5,"hasGoodQuality"),e.TgZ(6,"ion-button",11),e.NdJ("click",function(){const o=e.CHM(i).$implicit,s=e.oxw();return e.KtG(s.clickOnRain(o))}),e._uU(7,"details"),e.qZA(),e.TgZ(8,"ion-progress-bar",12),e.NdJ("click",function(){const o=e.CHM(i).$implicit,s=e.oxw();return e.KtG(s.clickOnRain(o))}),e.ALo(9,"progressBuffer"),e.ALo(10,"progressValue"),e.qZA(),e.TgZ(11,"ion-icon",13),e.NdJ("click",function(){const o=e.CHM(i).$implicit,s=e.oxw();return e.KtG(s.clickOnRain(o))}),e.qZA(),e.TgZ(12,"ion-icon",14),e.NdJ("click",function(){const o=e.CHM(i).$implicit,s=e.oxw();return e.KtG(s.clickOnRain(o))}),e.qZA()()()}if(2&a){const i=l.$implicit;e.xp6(2),e.Q6J("ngIf",e.lcZ(3,4,i)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(5,6,i)),e.xp6(4),e.s9C("buffer",e.lcZ(9,8,i)),e.s9C("value",e.lcZ(10,10,i))}}let D=(()=>{var a;class l{constructor(t,n){this.router=t,this.profile=n,this.rainsInfoAlreadyViewed={},this.rains=[]}ngOnInit(){this.refresh()}refresh(t){var n=this;return(0,c.Z)(function*(){try{n.sessionData=yield n.profile.refreshProfile(),n.sessionData.infos.rainsInfoAlreadyViewed&&(n.rainsInfoAlreadyViewed=n.sessionData.infos.rainsInfoAlreadyViewed),n.rains=yield n.profile.getRains(n.profile.asTeamId)}catch(o){console.error("refresh pb:",o)}t&&t.target.complete()})()}clickOnRain(t){return this.router.navigate(["/rains",t.id])}closeInfo(t){var n=this;return(0,c.Z)(function*(){n.rainsInfoAlreadyViewed[t]=!0,n.sessionData&&n.sessionData.infos&&(n.sessionData.infos.rainsInfoAlreadyViewed=n.rainsInfoAlreadyViewed,yield n.profile.storeAll())})()}}return(a=l).\u0275fac=function(t){return new(t||a)(e.Y36(h.F0),e.Y36(x.H))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-rains"]],viewQuery:function(t,n){if(1&t&&e.Gf(r.ki,5),2&t){let o;e.iGM(o=e.CRH())&&(n.modal=o.first)}},decls:16,vars:2,consts:[["slot","start"],["src","assets/icon/favicon.ico",2,"height","30px","padding-left","20px"],["slot","fixed",3,"ionRefresh"],["class","welcome-card",4,"ngIf"],[4,"ngFor","ngForOf"],["horizontal","end","slot","fixed","vertical","bottom"],["name","add"],[1,"welcome-card"],["fill","outline",3,"click"],["color","success","name","radio-button-off","slot","start",4,"ngIf"],["color","warning","name","radio-button-off","slot","start",4,"ngIf"],["expand","block",3,"click"],["color","primary",3,"buffer","value","click"],["color","primary","name","cloud-done","slot","end",3,"click"],["color","primary","name","arrow-right","slot","end",3,"click"],["color","success","name","radio-button-off","slot","start"],["color","warning","name","radio-button-off","slot","start"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-menu-button")(4,"ion-img",1),e.qZA(),e.TgZ(5,"ion-title"),e._uU(6," Rain zones "),e.qZA()()(),e.TgZ(7,"ion-content")(8,"ion-refresher",2),e.NdJ("ionRefresh",function(s){return n.refresh(s)}),e._UZ(9,"ion-refresher-content"),e.qZA(),e.YNc(10,R,11,0,"ion-card",3),e.TgZ(11,"ion-list"),e.YNc(12,v,13,12,"ion-item-sliding",4),e.qZA(),e.TgZ(13,"ion-fab",5)(14,"ion-fab-button"),e._UZ(15,"ion-icon",6),e.qZA()()()),2&t&&(e.xp6(10),e.Q6J("ngIf",!n.rainsInfoAlreadyViewed.hasOwnProperty("welcome-card")),e.xp6(2),e.Q6J("ngForOf",n.rains))},dependencies:[m.sg,m.O5,r.YG,r.Sm,r.PM,r.FN,r.Zi,r.tO,r.Dq,r.W2,r.IJ,r.W4,r.Gu,r.gu,r.Xz,r.Ie,r.td,r.q_,r.fG,r.X7,r.nJ,r.Wo,r.wd,r.sr,f.UA,f.$j,f.XW],styles:[".vertical-align-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:flex!important;align-content:center!important;align-items:center!important}.content-card[_ngcontent-%COMP%]{margin-bottom:100px}ion-list[_ngcontent-%COMP%]{margin-bottom:50px}"]}),l})();var p=g(8525),y=g(3900),M=g(3471),w=g(4948),A=g(3432),I=g(3060),b=g(6324);function N(a,l){1&a&&e._UZ(0,"ion-icon",26)}function U(a,l){1&a&&e._UZ(0,"ion-icon",27)}function J(a,l){if(1&a&&(e.TgZ(0,"ion-item")(1,"ion-card",28)(2,"ion-card-content"),e._UZ(3,"raain-date-focus",29),e.qZA()()()),2&a){const i=e.oxw(2);e.xp6(3),e.Q6J("currentHeight",300)("points",i.countPoints)}}function k(a,l){if(1&a){const i=e.EpF();e.TgZ(0,"ion-button",30),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().ngIf,o=e.oxw();return e.KtG(o.refreshMap(n))}),e._uU(1," refresh map "),e.qZA()}}function G(a,l){1&a&&e._UZ(0,"ion-progress-bar",31)}function q(a,l){if(1&a){const i=e.EpF();e.TgZ(0,"ion-item"),e._UZ(1,"ion-icon",32),e.TgZ(2,"ion-label",33),e._uU(3),e.qZA(),e.TgZ(4,"ion-toggle",6),e.NdJ("ionChange",function(n){e.CHM(i);const o=e.oxw(2);return e.KtG(o.onToggleMap(n))})("ngModelChange",function(n){e.CHM(i);const o=e.oxw(2);return e.KtG(o.toggleMap=n)}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(3),e.lnq(" Radar Measures: ",i.countsPeriod.radarMeasures," Gauge Measures: ",i.countsPeriod.gaugeMeasures," Rain Computations: ",i.countsPeriod.computationsByTeam," "),e.xp6(1),e.Q6J("ngModel",i.toggleMap)("checked",i.toggleMap)}}const S=function(){return[]},Q=function(a,l,i,t,n,o){return{gauges:a,borders:l,gaugesInCompare:i,selectedGauges:t,pixels:n,pixelsSolution:o}};function O(a,l){if(1&a){const i=e.EpF();e.TgZ(0,"ion-item")(1,"ion-grid")(2,"ion-row")(3,"ion-col",34)(4,"ion-card",35)(5,"ion-card-content")(6,"raain-map",36),e.NdJ("changedDate",function(n){e.CHM(i);const o=e.oxw(2);return e.KtG(o.onDateChangeInMap(n))})("selectedMarker",function(n){e.CHM(i);const o=e.oxw(2);return e.KtG(o.onGaugeSelectInMap(n))}),e.qZA()()()()()()()}if(2&a){const i=e.oxw(2);e.xp6(6),e.Q6J("coordinates",i.coordinates)("currentHeight",300)("defaultDate",i.dateShown)("markers",e.HTZ(9,Q,i.gauges,i.borders,i.compareManager.gaugesInCompare,i.compareManager.selectedGauges,i.compareManager.selectedPixels,e.DdM(8,S)))("sumFn",i.reportManager.sumFn)("sumValues",i.reportManager.sumValues)("timeframeContainers",i.timeframeContainers)("timeframeDates",i.timeframeDates)}}function H(a,l){if(1&a){const i=e.EpF();e.TgZ(0,"ion-item",37)(1,"raain-compare-stack",38),e.NdJ("selectedPoint",function(n){e.CHM(i);const o=e.oxw(2);return e.KtG(o.onGaugeSelectInCompare(n))}),e.qZA()()}if(2&a){const i=e.oxw(2);e.xp6(1),e.Q6J("compareManager",i.compareManager)("cumulative",i.toggleCumulative)}}function F(a,l){if(1&a&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&a){const i=e.oxw(3);e.xp6(1),e.hij(" ",e.xi3(2,1,i.compareManager.currentQualityDoneDate,"yyyy-MM-dd HH:mm"),"")}}function Y(a,l){if(1&a&&(e.TgZ(0,"span",40),e._uU(1),e.ALo(2,"date"),e.qZA()),2&a){const i=e.oxw(3);e.xp6(1),e.hij(" ",e.xi3(2,1,i.compareManager.currentQualityDoneDate,"yyyy-MM-dd HH:mm"),"")}}function B(a,l){if(1&a&&(e.TgZ(0,"ion-item")(1,"small"),e.YNc(2,F,3,4,"span",2),e.YNc(3,Y,3,4,"span",39),e._uU(4),e.qZA()()),2&a){const i=e.oxw(2);e.xp6(2),e.Q6J("ngIf",(null==i.refreshManager.rainComputationMapDoneDate?null:i.refreshManager.rainComputationMapDoneDate.getTime())<=(null==i.compareManager.currentQualityDoneDate?null:i.compareManager.currentQualityDoneDate.getTime())),e.xp6(1),e.Q6J("ngIf",(null==i.refreshManager.rainComputationMapDoneDate?null:i.refreshManager.rainComputationMapDoneDate.getTime())>(null==i.compareManager.currentQualityDoneDate?null:i.compareManager.currentQualityDoneDate.getTime())),e.xp6(1),e.lnq(" launchedBy: ",i.compareManager.currentQualityLaunchedBy," version: ",i.compareManager.compareVersion," timeSpentInMs: ",i.compareManager.currentQualityTimeSpentInMs," ")}}function E(a,l){if(1&a){const i=e.EpF();e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",20),e.NdJ("click",function(){e.CHM(i);const n=e.oxw(2);return e.KtG(n.modalCancel())}),e._uU(4,"Cancel"),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"Ask support"),e.qZA(),e.TgZ(7,"ion-buttons",41)(8,"ion-button",42),e.NdJ("click",function(){e.CHM(i);const n=e.oxw().ngIf,o=e.oxw();return e.KtG(o.modalAsk(n,o.modalMessage))}),e._uU(9,"Ask"),e.qZA()()()(),e.TgZ(10,"ion-content",43)(11,"ion-item")(12,"ion-label",44),e._uU(13,"Enter your message"),e.qZA(),e.TgZ(14,"ion-input",45),e.NdJ("ngModelChange",function(n){e.CHM(i);const o=e.oxw(2);return e.KtG(o.modalMessage=n)}),e.qZA()()()}if(2&a){const i=e.oxw(2);e.xp6(8),e.Q6J("strong",!0),e.xp6(6),e.Q6J("ngModel",i.modalMessage)}}function K(a,l){if(1&a){const i=e.EpF();e.TgZ(0,"ion-content")(1,"ion-list",3)(2,"ion-item"),e.YNc(3,N,1,0,"ion-icon",4),e.ALo(4,"hasGoodQuality"),e.YNc(5,U,1,0,"ion-icon",5),e.ALo(6,"hasGoodQuality"),e.TgZ(7,"ion-card-title"),e._uU(8),e.qZA(),e.TgZ(9,"ion-card-subtitle"),e._uU(10),e.qZA(),e.TgZ(11,"ion-toggle",6),e.NdJ("ionChange",function(){const o=e.CHM(i).ngIf,s=e.oxw();return e.KtG(s.onEnableCountHistoryTab(o))})("ngModelChange",function(n){e.CHM(i);const o=e.oxw();return e.KtG(o.toggleHistory=n)}),e.qZA()(),e.YNc(12,J,4,2,"ion-item",2),e.TgZ(13,"ion-item"),e._UZ(14,"ion-icon",7),e.TgZ(15,"ion-label",8),e._uU(16," Start "),e.TgZ(17,"input",9),e.NdJ("change",function(n){e.CHM(i);const o=e.oxw();return e.KtG(o.onPeriodBeginChange(n))}),e.qZA(),e._uU(18," \xa0During "),e.qZA(),e.TgZ(19,"ion-select",10),e.NdJ("ionDismiss",function(n){e.CHM(i);const o=e.oxw();return e.KtG(o.onPeriodDurationChange(n))})("ngModelChange",function(n){e.CHM(i);const o=e.oxw();return e.KtG(o.periodDurationAsString=n)}),e.TgZ(20,"ion-select-option",11),e._uU(21,"30 minutes"),e.qZA(),e.TgZ(22,"ion-select-option",12),e._uU(23,"1 hour"),e.qZA(),e.TgZ(24,"ion-select-option",13),e._uU(25,"2 hours"),e.qZA(),e.TgZ(26,"ion-select-option",14),e._uU(27,"3 hours"),e.qZA(),e.TgZ(28,"ion-select-option",15),e._uU(29,"4 hours"),e.qZA(),e.TgZ(30,"ion-select-option",16),e._uU(31,"5 hours"),e.qZA(),e.TgZ(32,"ion-select-option",17),e._uU(33,"6 hours"),e.qZA()(),e.TgZ(34,"ion-label"),e._uU(35),e.qZA(),e.YNc(36,k,2,0,"ion-button",18),e.qZA(),e.YNc(37,G,1,0,"ion-progress-bar",19),e.YNc(38,q,5,5,"ion-item",2),e.YNc(39,O,7,16,"ion-item",2),e.TgZ(40,"ion-button",20),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.launchComputation())}),e._uU(41,"compute this date"),e.qZA(),e.TgZ(42,"ion-button",20),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.onReportClick())}),e._uU(43,"report"),e.qZA(),e.TgZ(44,"ion-button",20),e.NdJ("click",function(){e.CHM(i);const n=e.oxw();return e.KtG(n.onReportCumulativeClick())}),e._uU(45,"cumul report"),e.qZA(),e.YNc(46,H,2,2,"ion-item",21),e.YNc(47,B,5,5,"ion-item",2),e.TgZ(48,"ion-item")(49,"span"),e._uU(50),e.qZA()()(),e.TgZ(51,"ion-modal",22),e.YNc(52,E,15,2,"ng-template"),e.qZA(),e.TgZ(53,"ion-fab",23)(54,"ion-fab-button",24),e._UZ(55,"ion-icon",25),e.qZA()()()}if(2&a){const i=l.ngIf,t=e.oxw();e.xp6(3),e.Q6J("ngIf",e.lcZ(4,17,i)),e.xp6(2),e.Q6J("ngIf",!e.lcZ(6,19,i)),e.xp6(3),e.Oqu(i.name),e.xp6(2),e.hij("by ",null==t.teamNode?null:t.teamNode.name,""),e.xp6(1),e.Q6J("ngModel",t.toggleHistory)("checked",t.toggleHistory),e.xp6(1),e.Q6J("ngIf",t.toggleHistory),e.xp6(5),e.Q6J("value",t.periodBeginAsString),e.xp6(2),e.Q6J("ngModel",t.periodDurationAsString),e.xp6(16),e.Oqu(t.onChangeDetectionTest(i)),e.xp6(1),e.Q6J("ngIf",!t.refreshInProgress),e.xp6(1),e.Q6J("ngIf",t.refreshInProgress),e.xp6(1),e.Q6J("ngIf",t.countsPeriod.radarMeasures),e.xp6(1),e.Q6J("ngIf",t.toggleMap),e.xp6(7),e.Q6J("ngIf",t.toggleMap),e.xp6(1),e.Q6J("ngIf",t.toggleMap),e.xp6(3),e.Oqu(t.appVersion)}}const L=[{path:"",children:[{path:"",component:D},{path:":id",component:(()=>{var a;class l{constructor(t,n,o,s){this.activatedRoute=t,this.profileService=n,this.radarService=o,this.storage=s,this.appVersion=w.i}static PeriodDisplay(t){let n=new Date;if(t){n=new Date(t);const s=6e4*n.getTimezoneOffset();n=new Date(n.getTime()-s)}return n.toISOString().substring(0,"2017-06-01T08:30".length)}ngAfterViewInit(){this.init()}ngOnDestroy(){this.cleanAll()}onEnableCountHistoryTab(t){var n=this;return(0,c.Z)(function*(){if(n.toggleHistory){const o=yield n.profileService.getCounts(t.getId());n.countPoints=[{label:"Nb Radar Measures",style:"bar",values:o.radarMeasures.map(s=>({date:new Date(s.name),value:s.x}))},{label:"Nb Gauge Measures",style:"line",values:o.gaugeMeasures.map(s=>({date:new Date(s.name),value:s.x/100}))},{label:"Nb Computations",style:"bar",values:o.computationsByTeam.map(s=>({date:new Date(s.name),value:s.x}))}]}else n.countPoints=[]})()}onPeriodBeginChange(t){var n=this;return(0,c.Z)(function*(){var o;const s=null!=t&&null!==(o=t.target)&&void 0!==o&&o.value?t.target.value:n.periodBeginAsString;n.periodBegin=new Date(s),n.periodBeginAsString=s,n.storage.set("rainDetail-periodBegin",n.periodBegin),yield n.onPeriodDurationChange(t)})()}onPeriodDurationChange(t){var n=this;return(0,c.Z)(function*(){const o=parseFloat(n.periodDurationAsString);n.periodEnd=new Date(n.periodBegin.getTime()+36e5*o),n.periodEndAsString=n.periodEnd.toISOString(),n.storage.set("rainDetail-periodEnd",n.periodEnd),n.refreshManager.setPeriod(n.periodBegin,n.periodEnd).then(s=>{})})()}onDateChangeInMap(t){var n=this;return(0,c.Z)(function*(){n.dateShown=t,n.currentTimeframeTarget=yield n.refreshManager.fetch(n.dateShown,n.toggleGaugeMeasures)})()}onGaugeSelectInMap(t){var n=this;return(0,c.Z)(function*(){var o;const s=n.gauges.filter(_=>_.lat===t.lat&&_.lng===t.lng);1===s.length&&(yield n.refreshManager.selectGauge(null===(o=s[0])||void 0===o?void 0:o.id,0))})()}onGaugeSelectInCompare(t){var n=this;return(0,c.Z)(function*(){yield n.refreshManager.selectGauge(t.point.id,t.compareIndex)})()}onToggleMap(t){var n=this;return(0,c.Z)(function*(){n.toggleMap&&(yield n.refreshMap(n.rainNode))})()}onChangeDetectionTest(t){return""}refreshMap(t){var n=this;return(0,c.Z)(function*(){n.gauges=yield n.getAllGauges(t),n.borders=[],n.refreshManager.refresh(!1).then(o=>{})})()}modalAsk(t,n){var o=this;return(0,c.Z)(function*(){return yield o.profileService.createNotification(t.getId(),"Rain: "+t.getId()+" Period: "+o.periodBegin.toISOString()+" - "+o.periodEnd.toISOString()+" Message: "+n),o.modal.dismiss(null,"confirm")})()}modalCancel(){var t=this;return(0,c.Z)(function*(){return t.modal.dismiss(null,"cancel")})()}onReportClick(){var t=this;return(0,c.Z)(function*(){yield t.reportManager.setDate(t.dateShown)})()}onReportCumulativeClick(){var t=this;return(0,c.Z)(function*(){yield t.reportManager.setPeriod(t.periodBegin,t.periodEnd)})()}launchComputation(){var t=this;return(0,c.Z)(function*(){yield t.profileService.launchRainComputation(t.rainNode.getId(),t.dateShown)})()}init(){this.cleanAll(),this.rain$=this.activatedRoute.paramMap.pipe((0,y.w)(t=>this.profileService.getRain(t.get("id")))),this.rain$.subscribe(this.initRain.bind(this))}cleanAll(){var t,n;this.gauges=[],this.borders=[],this.gaugesToFilter=[],this.rainNodeGauges=[],this.rainNode=null,this.radarNode=null,this.timeframeContainers=new M.TimeframeContainers([]),this.currentTimeframeTarget=null,this.timeframeDates=[],this.countPoints=[],this.countsPeriod={radarMeasures:null,gaugeMeasures:null,computationsByTeam:null},this.toggleHistory=!1,this.toggleMap=!1,this.toggleCompare=!1,this.toggleGaugeMeasures=!1,this.toggleRemoveCompareDuplicate=!0,this.periodBegin=new Date(this.storage.get("rainDetail-periodBegin")),this.periodEnd=new Date(this.storage.get("rainDetail-periodEnd")),this.periodBeginAsString=l.PeriodDisplay(this.periodBegin),this.periodEndAsString=l.PeriodDisplay(this.periodEnd),this.periodDurationAsString=""+(this.periodEnd.getTime()-this.periodBegin.getTime())/36e5,this.dateShown=this.periodBegin,this.refreshInProgress=!1,null===(t=this.compareManager)||void 0===t||t.cleanAll(),null===(n=this.refreshManager)||void 0===n||n.cleanAll()}initRain(t){var n=this;return(0,c.Z)(function*(){n.rainNode=t,n.compareManager=new p.jC(n.rainNode,n.profileService),n.refreshManager=new p.mO(n.rainNode,n.radarService,n.profileService,n.compareManager,n.onRefreshInProgress.bind(n),n.onRefreshDone.bind(n),n.onFetchDone.bind(n)),n.refreshManager.setRemoveDuplicate(!0),n.reportManager=new p.Ec(n.rainNode,n.radarService,n.profileService);const o=n.rainNode.getCenter();if(n.coordinates=new M.MapLatLng(o.lat,o.lng),n.teamNode=yield n.profileService.getTeam(t.getLinkId("team")),1===t.getLinksCount("radar")){const _=t.getLinkId("radar");n.radarNode=yield n.profileService.getRadar(_)}n.periodBegin&&n.periodEnd&&n.refreshManager.setPeriod(n.periodBegin,n.periodEnd).then(function(){var _=(0,c.Z)(function*(u){yield n.refreshManager.refresh(!1)});return function(u){return _.apply(this,arguments)}}())})()}getAllGauges(t){var n=this;return(0,c.Z)(function*(){const o=yield n.profileService.getGauges(null==t?void 0:t.getId());n.gaugesToFilter=o.sort((u,T)=>u.approxDistanceFrom(t.getCenter())-T.approxDistanceFrom(t.getCenter())).filter((u,T)=>T<200),n.rainNodeGauges=t.getLinks("gauge").map(u=>u.getId());const s=n.gaugesToFilter.filter(u=>n.rainNodeGauges.indexOf(u.id)>-1),_=[];for(const u of s)_.push(new M.MapLatLng(u.latitude,u.longitude,void 0,u.id,u.name));return _})()}onRefreshInProgress(t,n){var o=this;return(0,c.Z)(function*(){console.log("onRefreshInProgress",t),o.refreshInProgress=!0,o.countsPeriod=t,o.timeframeDates=n})()}onRefreshDone(t){var n=this;return(0,c.Z)(function*(){console.log("onRefreshDone",n.dateShown,t.length),n.timeframeDates=t,n.refreshInProgress=!1})()}onFetchDone(t){var n=this;return(0,c.Z)(function*(){console.log("fetch done",t),n.timeframeContainers=t})()}}return(a=l).\u0275fac=function(t){return new(t||a)(e.Y36(h.gz),e.Y36(p.H3),e.Y36(p.zL),e.Y36(p.Ke))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-rain-detail"]],viewQuery:function(t,n){if(1&t&&e.Gf(r.ki,5),2&t){let o;e.iGM(o=e.CRH())&&(n.modal=o.first)}},decls:9,vars:3,consts:[["slot","start"],["src","assets/icon/favicon.ico",2,"height","30px","padding-left","20px"],[4,"ngIf"],["lines","none"],["color","success","name","radio-button-off","slot","start",4,"ngIf"],["color","warning","name","radio-button-off","slot","start",4,"ngIf"],["slot","end",3,"ngModel","checked","ionChange","ngModelChange"],["name","calendar","slot","start"],["slot","start",2,"max-width","fit-content"],["type","datetime-local",3,"value","change"],["interface","popover","slot","start",3,"ngModel","ionDismiss","ngModelChange"],["value","0.5"],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["slot","end",3,"click",4,"ngIf"],["color","primary","type","indeterminate",4,"ngIf"],[3,"click"],["class","ion-align-items-start",4,"ngIf"],["trigger","open-modal"],["horizontal","end","slot","fixed","vertical","bottom"],["id","open-modal"],["name","help"],["color","success","name","radio-button-off","slot","start"],["color","warning","name","radio-button-off","slot","start"],["id","card-count"],[3,"currentHeight","points"],["slot","end",3,"click"],["color","primary","type","indeterminate"],["name","map","slot","start"],[2,"color","lightgray","font-size","small"],["size-lg","12"],["id","card-map"],[3,"coordinates","currentHeight","defaultDate","markers","sumFn","sumValues","timeframeContainers","timeframeDates","changedDate","selectedMarker"],[1,"ion-align-items-start"],[3,"compareManager","cumulative","selectedPoint"],["style","color: red; font-size: larger",4,"ngIf"],[2,"color","red","font-size","larger"],["slot","end"],[3,"strong","click"],[1,"ion-padding"],["position","stacked"],["placeholder","Your message","type","text",3,"ngModel","ngModelChange"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-menu-button")(4,"ion-img",1),e.qZA(),e.TgZ(5,"ion-title"),e._uU(6," Radar To Rain - Details "),e.qZA()()(),e.YNc(7,K,56,21,"ion-content",2),e.ALo(8,"async")),2&t&&(e.xp6(7),e.Q6J("ngIf",e.lcZ(8,1,n.rain$)))},dependencies:[m.O5,d.JJ,d.On,r.YG,r.Sm,r.PM,r.FN,r.tO,r.Dq,r.wI,r.W2,r.IJ,r.W4,r.jY,r.Gu,r.gu,r.Xz,r.pK,r.Ie,r.Q$,r.q_,r.fG,r.X7,r.Nd,r.t9,r.n0,r.wd,r.ho,r.sr,r.ki,r.w,r.QI,r.j9,A.g,I.A,b.j,m.Ov,m.uU,f.UA],styles:[".vertical-align-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:flex!important;align-items:center!important}ion-spinner[_ngcontent-%COMP%]{width:17px;height:17px}ion-card-subtitle[_ngcontent-%COMP%]{padding-left:20px}#gauge-select-item[_ngcontent-%COMP%]{width:100%}#gauge-select-item[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{max-width:400px}#card-count[_ngcontent-%COMP%]{width:100%}#card-conf-quality[_ngcontent-%COMP%]{width:400px}#card-perf-container[_ngcontent-%COMP%]{visibility:hidden;display:none}.cpu-bars[_ngcontent-%COMP%]{width:60px;height:60px;margin-right:20px}.cpu-lines[_ngcontent-%COMP%]{width:100px}raain-compare-stack[_ngcontent-%COMP%]{width:100%}"]}),l})()},{path:"new-instance",component:(()=>{var a;class l{constructor(t,n){this.modalController=t,this.navParams=n}dismiss(){this.modalController.dismiss()}add(t,n,o){this.modalController.dismiss()}}return(a=l).\u0275fac=function(t){return new(t||a)(e.Y36(r.IN),e.Y36(r.X1))},a.\u0275cmp=e.Xpm({type:a,selectors:[["modal-page"]],inputs:{value:"value"},decls:19,vars:4,consts:[["padding",""],["heroForm","ngForm"],["type","url","placeholder","https://RadarToRain.you/RadarToRain","required","","name","RadarToRainUrl",3,"ngModel","ngModelChange"],["type","string","placeholder","User","required","","name","RadarToRainUser",3,"ngModel","ngModelChange"],["type","password","placeholder","Password","required","","name","RadarToRainPwd",3,"ngModel","ngModelChange"],["expand","block",3,"disabled","click"],["expand","block",3,"click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"ion-content",0)(1,"ion-card")(2,"ion-card-header")(3,"ion-card-title"),e._uU(4,"Connect your RadarToRain instance"),e.qZA()(),e.TgZ(5,"ion-card-content")(6,"form",null,1)(8,"ion-item")(9,"ion-input",2),e.NdJ("ngModelChange",function(s){return n.RadarToRainUrl=s}),e.qZA()(),e.TgZ(10,"ion-item")(11,"ion-input",3),e.NdJ("ngModelChange",function(s){return n.RadarToRainUser=s}),e.qZA()(),e.TgZ(12,"ion-item")(13,"ion-input",4),e.NdJ("ngModelChange",function(s){return n.RadarToRainPwd=s}),e.qZA()(),e.TgZ(14,"div")(15,"ion-button",5),e.NdJ("click",function(){return n.add(n.RadarToRainUrl,n.RadarToRainUser,n.RadarToRainPwd)}),e._uU(16,"Login "),e.qZA(),e.TgZ(17,"ion-button",6),e.NdJ("click",function(){return n.dismiss()}),e._uU(18,"dismiss "),e.qZA()()()()()()),2&t){const o=e.MAs(7);e.xp6(9),e.Q6J("ngModel",n.RadarToRainUrl),e.xp6(2),e.Q6J("ngModel",n.RadarToRainUser),e.xp6(2),e.Q6J("ngModel",n.RadarToRainPwd),e.xp6(2),e.Q6J("disabled",!n.RadarToRainUrl||!o.form.valid)}},dependencies:[d._Y,d.JJ,d.JL,d.Q7,d.On,d.F,r.YG,r.PM,r.FN,r.Zi,r.Dq,r.W2,r.pK,r.Ie,r.j9],encapsulation:2}),l})()}]}];let V=(()=>{var a;class l{}return(a=l).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[m.ez,d.u5,r.Pc,p.m8,h.Bz.forChild(L)]}),l})()}}]);